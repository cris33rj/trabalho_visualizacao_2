---
toc: false
---

<style> 
    p, li, ol, table, figure, figcaption, h1, h2, h3, h4, h5, h6, .katex-display
    {
        max-width:none;
        text-align: justify;
        margin: 15px 15px;
        text-wrap: pretty;
    }
</style>

# 2.4 - Análise dos tipos de acidentes

### Análise dos tipos de acidentes ocorridos no período e por região.

Esta análise visa responder as seguintes questões:

1) Quais tipos de infração são as mais comuns?
2) Há variações nas infrações mais comuns por estado?
3) Há relação entra as infrações mais comuns e a relação com turismo ou com trabalho?


Inicialmente cabe verificar a distribuição por estado no número geral de acidentes registrados pela Polícia rodoviário Federal. Assim, disponibilizamos abaixo os mapas **A1**, **A2**, **A3** e **A4**, respectivamente contabilizando os acidentes ocorridos e registrados pela PRF nos anos de 2021, 2022, 2023 e 2024:

<div class="grid grid-cols">
  <div id="ex01" class="card">
      <h4>O 12 acidentes mais comuns registrados pela PRF ano de 2021.</h4>
      <div style="width: 100%, margin-top: 15px;">
        ${ vl.render(ex01(divWidth-150)) }
      </div>
      <h5>OBS: Ao posicionar o mouse sobre as regiões é possível avaliar os números.</h5>
  </div>
</div>

<div class="grid grid-cols">
  <div id="ex02" class="card">
      <h4>O 12 acidentes mais comuns registrados pela PRF ano de 2021.</h4>
      <div style="width: 100%, margin-top: 15px;">
        ${ vl.render(ex02(divWidth-150)) }
      </div>
      <h5>OBS: Ao posicionar o mouse sobre as regiões é possível avaliar os números.</h5>
  </div>
</div>

<div class="grid grid-cols">
  <div id="ex03" class="card">
      <h4>O 12 acidentes mais comuns registrados pela PRF ano de 2021.</h4>
      <div style="width: 100%, margin-top: 15px;">
        ${ vl.render(ex03(divWidth-150)) }
      </div>
      <h5>OBS: Ao posicionar o mouse sobre as regiões é possível avaliar os números.</h5>
  </div>
</div>

<div class="grid grid-cols">
  <div id="ex04" class="card">
      O 12 acidentes mais comuns registrados pela PRF ano de <select name="CMBAno" id="CMBAno">
        <option value=ex01>2021</option>
        <option value=ex02>2022</option>
        <option value=ex03>2023</option>
        <option value=ex04>2024</option>
      </select>
      ${  }
      <div style="width: 100%, margin-top: 15px;">
        ${ vl.render(ex04(divWidth-150, CMBAno.options[CMBAno.selectedIndex].text)) }
      </div>
      <h5>OBS: Ao posicionar o mouse sobre as regiões é possível avaliar os números.</h5>
  </div>
</div>

<div class="grid grid-cols">
    <div id="ex20" class="card">
        <h4>Acidentes por estado registrados pela PRF ano de 2022.</h4>
        <div style="width: 100%; margin-top: 15px;">
            ${ vl.render(ex20(divWidth-280)) }
        </div>
        <h5>OBS: Ao posicionar o mouse sobre as regiões é possível avaliar os números.</h5>
    </div>
</div>





```js
const br_states = await FileAttachment("./data/br_states.json").json({typed: true,});
const acidentes_por_estado = await FileAttachment("./data/acidentes_por_estado.csv").csv({ typed: true });
const acidentes_por_estado2021 = await FileAttachment("./data/acidentes_por_estado2021.csv").csv({ typed: true });
const acidentes_por_estado2022 = await FileAttachment("./data/acidentes_por_estado2022.csv").csv({ typed: true });
const acidentes_por_estado2023 = await FileAttachment("./data/acidentes_por_estado2023.csv").csv({ typed: true });
const acidentes_por_estado2024 = await FileAttachment("./data/acidentes_por_estado2024.csv").csv({ typed: true });
const acidentes_por_estado_21_a_24 = await FileAttachment("./data/acidentes_por_estado_21_a_24.csv").csv({ typed: true });


const datatran2024 = await FileAttachment("./data/datatran2024.json").json({typed: true,});
const datatran2023 = await FileAttachment("./data/datatran2023.json").json({typed: true,});
const datatran2022 = await FileAttachment("./data/datatran2022.json").json({typed: true,});
const datatran2021 = await FileAttachment("./data/datatran2021.json").json({typed: true,});



const brasil_completo = await FileAttachment("./data/brasil_completo.json").json({typed: true,});

const updated_taxa_acidentes_por_municipio = await FileAttachment("./data/updated_taxa_acidentes_por_municipio.csv").csv({  typed: true,});

const divWidth = Generators.width(document.querySelector("#ex01"));

import * as vega from "npm:vega";
import * as vegaLite from "npm:vega-lite";
import * as vegaLiteApi from "npm:vega-lite-api";

const vl = vegaLiteApi.register(vega, vegaLite);
  const selection = vl.selectPoint('uf') // name the selection 'Cars' (what will happen if we delete 'Cars'?)
    .fields('uf')          // limit selection to the Origin field
    .init(origin[0])          // use first genre entry as initial value
    .bind(vl.menu(origin))


function ex01(divWidth){
  return{
    spec:{
      width: divWidth,
      padding: 15,     
      "params": [
      {
        "name": "Ano",
        "bind": {"input": "select", "options": ["datatran2021","2022datatran2022","datatran2023","datatran2024"]},
      },
      {
        "select": {"type": "point", "on": "pointerover"},
      }
      ],
      data:{
        values:  {"expr": "Ano"},
      },
      title: "B1",
      "mark":{
          "type": "bar",
          "size": 5,
        },
      "transform":[
        {
          "aggregate":[
            {
              "field": ["causa_acidente"],
              "op": "count", 
              "as": "Num_acidentes",
            }
          ],
          "groupby": ["causa_acidente","uf"],
        },
        {"filter": "datum.Num_acidentes >= 300"},
      ],      
      "encoding":{
        "x":{
          "field": ["causa_acidente"],
          "type": "nominal",
          "aggregate": "causa_acidente",
          "sort":{
            "field": "Num_acidentes",
            "order": "descending"
          },        
          "title": "Tipos de acidentes", 
          "axis": {"labelAngle": 45}                                 
        },
        tooltip:[
          { field: "uf", type: "nominal", title: "Estado" },
          { field: "Num_acidentes", type: "quantitative", title: "Número de aciedentes" },
        ],
        "y":{
          "field": ["Num_acidentes"],
          "type": "quantitative",                    
          "title": "Quantidade de acidentes",    
        },
        "xOffset": {"field": "uf"},
        "color": {"field": "uf", "legend" : { "title": "UF"}}    
      }
    }
  }
}

function ex02(divWidth){
  return{
    spec:{
      width: divWidth,
      padding: 15,   
       "params": [
    { "name": "CMBAno", "value": 2021,
      "bind": {"input": "range", "min": 2021, "max": 2024, "step": 1} }
  ],
      data:{
        values: datatran2022
      },
      title: "B1",
      "mark":{
          "type": "bar",
          "size": 5,
        },
      "transform":[
        {
          "aggregate":[
            {
              "field": ["causa_acidente"],
              "op": "count", 
              "as": "Num_acidentes",
            }
          ],
          "groupby": ["causa_acidente","uf"],
        },
        {"filter": "datum.Num_acidentes >= 300"},
      ],      
      "encoding":{
        "x":{
          "field": ["causa_acidente"],
          "type": "nominal",
          "aggregate": "causa_acidente",
          "sort":{
            "field": "Num_acidentes",
            "order": "descending"
          },        
          "title": "Tipos de acidentes", 
          "axis": {"labelAngle": 45}                                 
        },
        tooltip:[
          { field: "uf", type: "nominal", title: "Estado" },
          { field: "Num_acidentes", type: "quantitative", title: "Número de aciedentes" },
        ],
        "y":{
          "field": ["Num_acidentes"],
          "type": "quantitative",                    
          "title": "Quantidade de acidentes",    
        },
        "xOffset": {"field": "uf"},
        "color": {"field": "uf", "legend" : { "title": "UF"}}    
      }
    }
  }
}

function ex03(divWidth){
  return{
    spec:{
      width: divWidth,
      padding: 15,   
      data:{
        values: datatran2023
      },
      title: "B1",
      "mark":{
          "type": "bar",
          "size": 5,
        },
      "transform":[
        {
          "aggregate":[
            {
              "field": ["causa_acidente"],
              "op": "count", 
              "as": "Num_acidentes",
            }
          ],
          "groupby": ["causa_acidente","uf"],
        },
        {"filter": "datum.Num_acidentes >= 300"},
      ],      
      "encoding":{
        "x":{
          "field": ["causa_acidente"],
          "type": "nominal",
          "aggregate": "causa_acidente",
          "sort":{
            "field": "Num_acidentes",
            "order": "descending"
          },        
          "title": "Tipos de acidentes", 
          "axis": {"labelAngle": 45}                                 
        },
        tooltip:[
          { field: "uf", type: "nominal", title: "Estado" },
          { field: "Num_acidentes", type: "quantitative", title: "Número de aciedentes" },
        ],
        "y":{
          "field": ["Num_acidentes"],
          "type": "quantitative",                    
          "title": "Quantidade de acidentes",    
        },
        "xOffset": {"field": "uf"},
        "color": {"field": "uf", "legend" : { "title": "UF"}}    
      }
    }
  }
}

function ex04(divWidth, VAno){
if (VAno == '2001' ) {
   return{
    spec:{
      "width": divWidth,
      "padding": 15,   
      "data":{
        "values": datatran2021
      },
      title: "B1",
      "mark":{
          "type": "bar",
          "size": 5,
        },
      "transform":[
        {
          "aggregate":[
            {
              "field": ["causa_acidente"],
              "op": "count", 
              "as": "Num_acidentes",
            }
          ],
          "groupby": ["causa_acidente","uf"],
        },
        {"filter": "datum.Num_acidentes >= 130"},
      ],      
      "encoding":{
        "x":{
          "field": ["causa_acidente"],
          "type": "nominal",
          "aggregate": "causa_acidente",
          "sort":{
            "field": "Num_acidentes",
            "order": "descending"
          },        
          "title": "Tipos de acidentes", 
          "axis": {"labelAngle": 45}                                 
        },
        tooltip:[
          { field: "uf", type: "nominal", title: "Estado" },
          { field: "Num_acidentes", type: "quantitative", title: "Número de aciedentes" },
        ],
        "y":{
          "field": ["Num_acidentes"],
          "type": "quantitative",                    
          "title": "Quantidade de acidentes",    
        },
        "xOffset": {"field": "uf"},
        "color": {"field": "uf", "legend" : { "title": "UF"}}    
      }
    }
  }
} else {
       return{
    spec:{
      "width": divWidth,
      "padding": 15,   
      "data":{
        "values": datatran2024
      },
      title: "B1",
      "mark":{
          "type": "bar",
          "size": 5,
        },
      "transform":[
        {
          "aggregate":[
            {
              "field": ["causa_acidente"],
              "op": "count", 
              "as": "Num_acidentes",
            }
          ],
          "groupby": ["causa_acidente","uf"],
        },
        {"filter": "datum.Num_acidentes >= 130"},
      ],      
      "encoding":{
        "x":{
          "field": ["causa_acidente"],
          "type": "nominal",
          "aggregate": "causa_acidente",
          "sort":{
            "field": "Num_acidentes",
            "order": "descending"
          },        
          "title": "Tipos de acidentes", 
          "axis": {"labelAngle": 45}                                 
        },
        tooltip:[
          { field: "uf", type: "nominal", title: "Estado" },
          { field: "Num_acidentes", type: "quantitative", title: "Número de aciedentes" },
        ],
        "y":{
          "field": ["Num_acidentes"],
          "type": "quantitative",                    
          "title": "Quantidade de acidentes",    
        },
        "xOffset": {"field": "uf"},
        "color": {"field": "uf", "legend" : { "title": "UF"}}    
      }
    }
  }
  }
}



function ex20(divWidth){
  return{
    spec:{
      width: divWidth,
      padding: 15,   
      data:{
        values: datatran2023
      },
      "title": "B2",
      "mark":{
          "type": "bar",
          "size": 7,
      },
      "transform":[
      {
        "aggregate":[
          {
            "field": ["causa_acidente"],
            "op": "count", 
            "as": "Cont_acidente",
          },
        ],
        "groupby": ["causa_acidente"],
      },
      ],
      "encoding":{
        "x":{
          "aggregate": "count",                   
          "title": "Quantidade de acidentes", 
        },
        "y":{
          "field": ["causa_acidente"],
          "type": "nominal",
          "aggregate": "causa_acidente",
          "sort":{
            "field": "Cont_acidente",
            "order": "ascending"
          },        
          "title": "Tipos de acidentes", 
          "axis": {"labelAngle": 0}                                 
        },
        "tooltip":[
          { "field": "uf", "type": "nominal", "title": "Estado" },
          { "aggregate": "count", "title": "Quantidade de acidentes" },
        ],

         "color": {
          "title": "UF",
          "field": "uf", 
          "scale": {
            "domain":[ "AC","AL","AM","AP","BA","CE","DF","ES","GO","MA","MG","MS","MT","PA","PB","PE","PI","PR","RJ","RN","RO","RR","RS","SC","SE","SP","TO" ],
          },
        },  
      },
      selection: 
      {
        Item: 
        {
          type: "multi",
          fields: ["uf"],
          bind: "legend",
        },
      },
      transform: [{ filter: { selection: "Item" } }, ],
    }
  }
}
```
